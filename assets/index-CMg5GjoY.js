import{d as $e,r as i,a as Q,v as je,k as Ke,D as He,N as we,c as Qe,e as t,w as l,f as d,O as Ge,E as S,x as ie,L as Je,m as k,b as s,P as G,t as _,j as u,g as F,Q as We,H as q,i as Xe,R as Ye,S as Ze,I as et,U as tt,K as lt,o as y}from"./index-VJYCWO8Z.js";import{g as J,i as W}from"./index-BjzP5g9D.js";import{_ as ot}from"./_plugin-vue_export-helper-DlAUqK2U.js";const at={class:"monitor-container"},st={class:"card-header"},nt={class:"header-right"},rt={class:"monitor-item"},it={class:"item-progress"},ut={class:"monitor-item"},dt={class:"item-progress"},pt={class:"monitor-item"},mt={class:"item-progress"},ct={class:"monitor-item"},vt={class:"item-progress"},ft={class:"monitor-charts"},gt={class:"card-header"},_t={class:"header-right"},yt={class:"operation-bar"},ht={class:"table-actions"},bt={class:"pagination"},wt={class:"card-header"},kt={class:"header-right"},xt={class:"pagination"},Ct={class:"dialog-footer"},Vt={class:"dialog-footer"},zt=$e({__name:"index",setup(Ut){const X=i(!1);let x=null;const c=Q({cpu:45,memory:60,storage:35,network:50}),I=i(!1),N=i([]),ue=i([{id:1,time:"2025-03-20 10:30:00",level:"critical",content:"服务器A CPU使用率超过90%",source:"服务器A",status:"pending",processMethod:"",processComment:"",processTime:""},{id:2,time:"2025-03-20 09:15:00",level:"warning",content:"存储阵列B空间使用率超过80%",source:"存储阵列B",status:"processing",processMethod:"",processComment:"",processTime:""},{id:3,time:"2025-03-19 16:45:00",level:"info",content:"系统有新补丁可用",source:"系统",status:"resolved",processMethod:"",processComment:"",processTime:""}]),C=i([...ue.value]),ke=i([{id:1,time:"2025-03-20 10:00:00",level:"info",module:"系统",content:"系统启动成功",operator:"系统管理员"},{id:2,time:"2025-03-20 09:55:00",level:"warning",module:"CPU",content:"CPU使用率超过80%",operator:"监控系统"}]),M=i(!1),O=i(!1),Y=i(),n=Q({name:"",type:"",level:"",threshold:80,duration:5,notifyMethods:["email"],description:""}),R=i(!1),Z=i(),g=Q({method:"",comment:""}),xe={name:[{required:!0,message:"请输入告警名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择告警类型",trigger:"change"}],level:[{required:!0,message:"请选择告警级别",trigger:"change"}],threshold:[{required:!0,message:"请输入阈值",trigger:"blur"}],duration:[{required:!0,message:"请输入持续时间",trigger:"blur"}],notifyMethods:[{required:!0,message:"请选择通知方式",trigger:"change"}]},Ce={method:[{required:!0,message:"请选择处理方式",trigger:"change"}],comment:[{required:!0,message:"请输入处理说明",trigger:"blur"}]},P=i(),T=i(),E=i(),L=i(),r=Q({keyword:"",level:"",status:""}),V=i(1),B=i(10),de=i(0),ee=i(1),te=i(10),Ve=i(0),pe=je(()=>!!r.level||!!r.status||!!r.keyword),ze=o=>({info:"info",warning:"warning",error:"danger"})[o]||"info",me=o=>o==="critical"?"严重":o==="warning"?"警告":o==="info"?"提示":o,ce=o=>o==="pending"?"未处理":o==="processing"?"处理中":o==="resolved"?"已处理":o,Ue=o=>o==="pending"?"danger":o==="processing"?"warning":o==="resolved"?"success":"info",$=i(!0),j=i(null),Se=()=>{$.value=!0,Ge(()=>{try{if(!P.value||!T.value||!E.value||!L.value){console.warn("Chart DOM elements not ready");return}const o=W(P.value);o.setOption({title:{text:"CPU使用率趋势"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:["00:00","03:00","06:00","09:00","12:00","15:00","18:00","21:00"]},yAxis:{type:"value",max:100},series:[{data:[30,40,35,50,45,60,55,45],type:"line",smooth:!0,areaStyle:{opacity:.3}}]});const e=W(T.value);e.setOption({title:{text:"内存使用率趋势"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:["00:00","03:00","06:00","09:00","12:00","15:00","18:00","21:00"]},yAxis:{type:"value",max:100},series:[{data:[50,55,60,65,70,65,60,55],type:"line",smooth:!0,areaStyle:{opacity:.3}}]});const z=W(E.value);z.setOption({title:{text:"存储使用率趋势"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:["00:00","03:00","06:00","09:00","12:00","15:00","18:00","21:00"]},yAxis:{type:"value",max:100},series:[{data:[35,38,40,42,45,43,40,38],type:"line",smooth:!0,areaStyle:{opacity:.3}}]});const b=W(L.value);b.setOption({title:{text:"网络带宽趋势"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:["00:00","03:00","06:00","09:00","12:00","15:00","18:00","21:00"]},yAxis:{type:"value",max:100},series:[{data:[45,50,48,55,60,58,52,48],type:"line",smooth:!0,areaStyle:{opacity:.3}}]});const w=()=>{try{o.resize(),e.resize(),z.resize(),b.resize()}catch(m){console.error("Error resizing charts:",m)}};window.addEventListener("resize",w),we(()=>{window.removeEventListener("resize",w);try{o.dispose(),e.dispose(),z.dispose(),b.dispose()}catch(m){console.error("Error disposing charts:",m)}}),$.value=!1}catch(o){console.error("Error initializing charts:",o),$.value=!1,S.error("图表初始化失败")}})},h=()=>{let o=[...ue.value];r.keyword&&(o=o.filter(e=>e.content.includes(r.keyword)||e.source.includes(r.keyword))),r.level&&(o=o.filter(e=>e.level===r.level)),r.status&&(o=o.filter(e=>e.status===r.status)),de.value=o.length,C.value=o.slice((V.value-1)*B.value,V.value*B.value)},ve=()=>{r.keyword="",r.level="",r.status="",V.value=1,h()},le=o=>{r[o]="",V.value=1,h()},Me=o=>{B.value=o,h()},Re=o=>{V.value=o,h()},Ae=o=>{te.value=o},Pe=o=>{ee.value=o};Ke(X,o=>{o?x=window.setInterval(()=>{fe()},3e4):x&&(clearInterval(x),x=null)});const fe=()=>{I.value=!0,setTimeout(()=>{I.value=!1,S.success("数据已刷新")},1e3)},Te=()=>{O.value=!1,M.value=!0,n.name="",n.type="",n.level="",n.threshold=80,n.duration=5,n.notifyMethods=["email"],n.description=""},Ee=o=>{O.value=!0,M.value=!0,n.name=o.name,n.type=o.type,n.level=o.level,n.threshold=o.threshold,n.duration=o.duration,n.notifyMethods=o.notifyMethods,n.description=o.description},Le=o=>{j.value=o,R.value=!0,g.method="",g.comment=""},Be=()=>{if(N.value.length===0){S.warning("请选择要处理的告警");return}j.value=N.value[0],R.value=!0,g.method="",g.comment=""},De=o=>{lt.confirm(`确认删除告警"${o.content}"吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{S.success("删除成功")})},Fe=()=>{S.success("日志导出中")},qe=async()=>{Y.value&&await Y.value.validate(o=>{o&&(M.value=!1,S.success(O.value?"编辑成功":"添加成功"))})},Ie=async()=>{Z.value&&Z.value.validate(o=>{if(o){const e=C.value.findIndex(z=>{var b;return z.id===((b=j.value)==null?void 0:b.id)});e!==-1&&(C.value[e].status="resolved",C.value[e].processMethod=g.method,C.value[e].processComment=g.comment,C.value[e].processTime=new Date().toLocaleString(),h(),S.success("处理成功")),R.value=!1,j.value=null}})},Ne=o=>{N.value=o};return He(()=>{setTimeout(()=>{Se()},100),h()}),we(()=>{x&&(clearInterval(x),x=null),[P.value&&J(P.value),T.value&&J(T.value),E.value&&J(E.value),L.value&&J(L.value)].forEach(e=>{e&&e.dispose()})}),(o,e)=>{const z=d("el-switch"),b=d("el-tooltip"),w=d("el-icon"),m=d("el-button"),K=d("el-progress"),U=d("el-col"),oe=d("el-row"),ae=d("el-card"),H=d("el-input"),v=d("el-form-item"),p=d("el-option"),D=d("el-select"),se=d("el-form"),A=d("el-tag"),f=d("el-table-column"),ge=d("el-table"),_e=d("el-pagination"),ye=d("el-input-number"),ne=d("el-checkbox"),Oe=d("el-checkbox-group"),he=d("el-dialog"),re=Je("loading");return y(),Qe("div",at,[t(oe,{gutter:20},{default:l(()=>[t(U,{span:24},{default:l(()=>[ie((y(),k(ae,{class:"monitor-card"},{header:l(()=>[s("div",st,[e[25]||(e[25]=s("span",null,"系统监控",-1)),s("div",nt,[t(b,{content:"自动刷新",placement:"top"},{default:l(()=>[t(z,{modelValue:X.value,"onUpdate:modelValue":e[0]||(e[0]=a=>X.value=a),"active-text":"自动"},null,8,["modelValue"])]),_:1}),t(m,{type:"primary",onClick:fe},{default:l(()=>[t(w,null,{default:l(()=>[t(F(We))]),_:1}),e[24]||(e[24]=u("刷新 "))]),_:1,__:[24]})])])]),default:l(()=>[t(oe,{gutter:20},{default:l(()=>[t(U,{span:6},{default:l(()=>[s("div",rt,[e[26]||(e[26]=s("div",{class:"item-title"},"CPU使用率",-1)),s("div",{class:G(["item-value",{warning:c.cpu>80}])},_(c.cpu)+"%",3),s("div",it,[t(K,{percentage:c.cpu,status:c.cpu>80?"exception":"","stroke-width":8},null,8,["percentage","status"])])])]),_:1}),t(U,{span:6},{default:l(()=>[s("div",ut,[e[27]||(e[27]=s("div",{class:"item-title"},"内存使用率",-1)),s("div",{class:G(["item-value",{warning:c.memory>80}])},_(c.memory)+"%",3),s("div",dt,[t(K,{percentage:c.memory,status:c.memory>80?"exception":"","stroke-width":8},null,8,["percentage","status"])])])]),_:1}),t(U,{span:6},{default:l(()=>[s("div",pt,[e[28]||(e[28]=s("div",{class:"item-title"},"存储使用率",-1)),s("div",{class:G(["item-value",{warning:c.storage>80}])},_(c.storage)+"%",3),s("div",mt,[t(K,{percentage:c.storage,status:c.storage>80?"exception":"","stroke-width":8},null,8,["percentage","status"])])])]),_:1}),t(U,{span:6},{default:l(()=>[s("div",ct,[e[29]||(e[29]=s("div",{class:"item-title"},"网络带宽",-1)),s("div",{class:G(["item-value",{warning:c.network>80}])},_(c.network)+"Mbps",3),s("div",vt,[t(K,{percentage:c.network,status:c.network>80?"exception":"","stroke-width":8},null,8,["percentage","status"])])])]),_:1})]),_:1}),s("div",ft,[s("div",{ref_key:"cpuChartRef",ref:P,class:"chart"},null,512),s("div",{ref_key:"memoryChartRef",ref:T,class:"chart"},null,512),s("div",{ref_key:"storageChartRef",ref:E,class:"chart"},null,512),s("div",{ref_key:"networkChartRef",ref:L,class:"chart"},null,512)])]),_:1})),[[re,$.value]])]),_:1}),t(U,{span:24,class:"mt-20"},{default:l(()=>[t(ae,null,{header:l(()=>[s("div",gt,[e[32]||(e[32]=s("span",null,"告警管理",-1)),s("div",_t,[t(m,{type:"success",onClick:Be,disabled:!N.value.length},{default:l(()=>[t(w,null,{default:l(()=>[t(F(Ze))]),_:1}),e[30]||(e[30]=u("批量处理 "))]),_:1,__:[30]},8,["disabled"]),t(m,{type:"primary",onClick:Te},{default:l(()=>[t(w,null,{default:l(()=>[t(F(et))]),_:1}),e[31]||(e[31]=u("添加告警规则 "))]),_:1,__:[31]})])])]),default:l(()=>[s("div",yt,[t(se,{inline:!0,model:r,class:"search-form"},{default:l(()=>[t(v,null,{default:l(()=>[t(H,{modelValue:r.keyword,"onUpdate:modelValue":e[1]||(e[1]=a=>r.keyword=a),placeholder:"告警内容/来源",clearable:"",onKeyup:Xe(h,["enter"])},{prefix:l(()=>[t(w,null,{default:l(()=>[t(F(Ye))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(v,null,{default:l(()=>[t(D,{modelValue:r.level,"onUpdate:modelValue":e[2]||(e[2]=a=>r.level=a),placeholder:"级别",clearable:"",style:{width:"120px"}},{default:l(()=>[t(p,{label:"严重",value:"critical"}),t(p,{label:"警告",value:"warning"}),t(p,{label:"提示",value:"info"})]),_:1},8,["modelValue"])]),_:1}),t(v,null,{default:l(()=>[t(D,{modelValue:r.status,"onUpdate:modelValue":e[3]||(e[3]=a=>r.status=a),placeholder:"状态",clearable:"",style:{width:"120px"}},{default:l(()=>[t(p,{label:"未处理",value:"pending"}),t(p,{label:"处理中",value:"processing"}),t(p,{label:"已处理",value:"resolved"})]),_:1},8,["modelValue"])]),_:1}),t(v,null,{default:l(()=>[t(m,{type:"primary",onClick:h},{default:l(()=>e[33]||(e[33]=[u("搜索")])),_:1,__:[33]}),t(m,{onClick:ve},{default:l(()=>e[34]||(e[34]=[u("重置")])),_:1,__:[34]})]),_:1})]),_:1},8,["model"])]),pe.value?(y(),k(oe,{key:0,class:"filter-tags",style:{"margin-bottom":"10px"}},{default:l(()=>[r.level?(y(),k(A,{key:0,type:"info",closable:"",onClose:e[4]||(e[4]=()=>le("level"))},{default:l(()=>[u(" 级别："+_(me(r.level)),1)]),_:1})):q("",!0),r.status?(y(),k(A,{key:1,type:"info",closable:"",onClose:e[5]||(e[5]=()=>le("status"))},{default:l(()=>[u(" 状态："+_(ce(r.status)),1)]),_:1})):q("",!0),r.keyword?(y(),k(A,{key:2,type:"info",closable:"",onClose:e[6]||(e[6]=()=>le("keyword"))},{default:l(()=>[u(" 关键词："+_(r.keyword),1)]),_:1})):q("",!0),pe.value?(y(),k(m,{key:3,size:"small",type:"text",onClick:ve},{default:l(()=>e[35]||(e[35]=[u("清除全部")])),_:1,__:[35]})):q("",!0)]),_:1})):q("",!0),ie((y(),k(ge,{data:C.value,border:"",style:{width:"100%"},onSelectionChange:Ne},{default:l(()=>[t(f,{type:"selection",width:"55"}),t(f,{prop:"time",label:"时间","min-width":"160",sortable:""}),t(f,{prop:"level",label:"级别","min-width":"80"},{default:l(({row:a})=>[t(A,{type:a.level==="critical"?"danger":a.level==="warning"?"warning":"info"},{default:l(()=>[u(_(me(a.level)),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"content",label:"内容","min-width":"200","show-overflow-tooltip":""}),t(f,{prop:"source",label:"来源","min-width":"120"}),t(f,{prop:"status",label:"状态","min-width":"100"},{default:l(({row:a})=>[t(A,{type:Ue(a.status)},{default:l(()=>[u(_(ce(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(f,{label:"操作",width:"280",fixed:"right"},{default:l(({row:a})=>[s("div",ht,[t(m,{type:"primary",link:"",onClick:be=>Le(a)},{default:l(()=>e[36]||(e[36]=[u("处理")])),_:2,__:[36]},1032,["onClick"]),t(m,{type:"success",link:"",onClick:be=>Ee(a)},{default:l(()=>e[37]||(e[37]=[u("编辑")])),_:2,__:[37]},1032,["onClick"]),t(m,{type:"danger",link:"",onClick:be=>De(a)},{default:l(()=>e[38]||(e[38]=[u("删除")])),_:2,__:[38]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[re,I.value]]),s("div",bt,[t(_e,{"current-page":V.value,"onUpdate:currentPage":e[7]||(e[7]=a=>V.value=a),"page-size":B.value,"onUpdate:pageSize":e[8]||(e[8]=a=>B.value=a),"page-sizes":[10,20,50,100],total:de.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Me,onCurrentChange:Re},null,8,["current-page","page-size","total"])])]),_:1})]),_:1}),t(U,{span:24,class:"mt-20"},{default:l(()=>[t(ae,null,{header:l(()=>[s("div",wt,[e[40]||(e[40]=s("span",null,"系统日志",-1)),s("div",kt,[t(m,{type:"primary",onClick:Fe},{default:l(()=>[t(w,null,{default:l(()=>[t(F(tt))]),_:1}),e[39]||(e[39]=u("导出日志 "))]),_:1,__:[39]})])])]),default:l(()=>[ie((y(),k(ge,{data:ke.value,style:{width:"100%"},border:""},{default:l(()=>[t(f,{prop:"time",label:"时间",width:"180",sortable:""}),t(f,{prop:"level",label:"级别",width:"100"},{default:l(({row:a})=>[t(A,{type:ze(a.level)},{default:l(()=>[u(_(a.level),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"module",label:"模块",width:"120"}),t(f,{prop:"content",label:"内容","show-overflow-tooltip":""}),t(f,{prop:"operator",label:"操作人",width:"120"})]),_:1},8,["data"])),[[re,I.value]]),s("div",xt,[t(_e,{"current-page":ee.value,"onUpdate:currentPage":e[9]||(e[9]=a=>ee.value=a),"page-size":te.value,"onUpdate:pageSize":e[10]||(e[10]=a=>te.value=a),"page-sizes":[10,20,50,100],total:Ve.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Ae,onCurrentChange:Pe},null,8,["current-page","page-size","total"])])]),_:1})]),_:1})]),_:1}),t(he,{modelValue:M.value,"onUpdate:modelValue":e[19]||(e[19]=a=>M.value=a),title:O.value?"编辑告警规则":"添加告警规则",width:"600px"},{footer:l(()=>[s("span",Ct,[t(m,{onClick:e[18]||(e[18]=a=>M.value=!1)},{default:l(()=>e[45]||(e[45]=[u("取消")])),_:1,__:[45]}),t(m,{type:"primary",onClick:qe},{default:l(()=>e[46]||(e[46]=[u("确定")])),_:1,__:[46]})])]),default:l(()=>[t(se,{ref_key:"alertFormRef",ref:Y,model:n,rules:xe,"label-width":"100px"},{default:l(()=>[t(v,{label:"告警名称",prop:"name"},{default:l(()=>[t(H,{modelValue:n.name,"onUpdate:modelValue":e[11]||(e[11]=a=>n.name=a),placeholder:"请输入告警名称"},null,8,["modelValue"])]),_:1}),t(v,{label:"告警类型",prop:"type"},{default:l(()=>[t(D,{modelValue:n.type,"onUpdate:modelValue":e[12]||(e[12]=a=>n.type=a),placeholder:"请选择告警类型"},{default:l(()=>[t(p,{label:"CPU告警",value:"cpu"}),t(p,{label:"内存告警",value:"memory"}),t(p,{label:"存储告警",value:"storage"}),t(p,{label:"网络告警",value:"network"}),t(p,{label:"应用告警",value:"application"}),t(p,{label:"安全告警",value:"security"})]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"告警级别",prop:"level"},{default:l(()=>[t(D,{modelValue:n.level,"onUpdate:modelValue":e[13]||(e[13]=a=>n.level=a),placeholder:"请选择告警级别"},{default:l(()=>[t(p,{label:"一般",value:"normal"}),t(p,{label:"警告",value:"warning"}),t(p,{label:"严重",value:"critical"})]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"阈值",prop:"threshold"},{default:l(()=>[t(ye,{modelValue:n.threshold,"onUpdate:modelValue":e[14]||(e[14]=a=>n.threshold=a),min:0,max:100},null,8,["modelValue"])]),_:1}),t(v,{label:"持续时间",prop:"duration"},{default:l(()=>[t(ye,{modelValue:n.duration,"onUpdate:modelValue":e[15]||(e[15]=a=>n.duration=a),min:1,max:60},null,8,["modelValue"]),e[41]||(e[41]=s("span",{class:"unit"},"分钟",-1))]),_:1,__:[41]}),t(v,{label:"通知方式",prop:"notifyMethods"},{default:l(()=>[t(Oe,{modelValue:n.notifyMethods,"onUpdate:modelValue":e[16]||(e[16]=a=>n.notifyMethods=a)},{default:l(()=>[t(ne,{label:"email"},{default:l(()=>e[42]||(e[42]=[u("邮件")])),_:1,__:[42]}),t(ne,{label:"sms"},{default:l(()=>e[43]||(e[43]=[u("短信")])),_:1,__:[43]}),t(ne,{label:"wechat"},{default:l(()=>e[44]||(e[44]=[u("微信")])),_:1,__:[44]})]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"描述"},{default:l(()=>[t(H,{modelValue:n.description,"onUpdate:modelValue":e[17]||(e[17]=a=>n.description=a),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(he,{modelValue:R.value,"onUpdate:modelValue":e[23]||(e[23]=a=>R.value=a),title:"处理告警",width:"500px"},{footer:l(()=>[s("span",Vt,[t(m,{onClick:e[22]||(e[22]=a=>R.value=!1)},{default:l(()=>e[47]||(e[47]=[u("取消")])),_:1,__:[47]}),t(m,{type:"primary",onClick:Ie},{default:l(()=>e[48]||(e[48]=[u("确定")])),_:1,__:[48]})])]),default:l(()=>[t(se,{ref_key:"processFormRef",ref:Z,model:g,rules:Ce,"label-width":"100px"},{default:l(()=>[t(v,{label:"处理方式",prop:"method"},{default:l(()=>[t(D,{modelValue:g.method,"onUpdate:modelValue":e[20]||(e[20]=a=>g.method=a),placeholder:"请选择处理方式"},{default:l(()=>[t(p,{label:"重启服务",value:"restart"}),t(p,{label:"清理缓存",value:"clear"}),t(p,{label:"扩容资源",value:"scale"}),t(p,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"处理说明",prop:"comment"},{default:l(()=>[t(H,{modelValue:g.comment,"onUpdate:modelValue":e[21]||(e[21]=a=>g.comment=a),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),At=ot(zt,[["__scopeId","data-v-3b7ccb94"]]);export{At as default};
