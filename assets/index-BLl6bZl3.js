import{d as ne,r as u,a as B,v as q,D as re,c as w,b as s,e as t,F as I,n as L,t as i,i as de,f as d,w as r,m as ie,j as v,H as ue,g as ce,I as ve,E as F,o as f,V as pe,P as me,K as _e}from"./index-DWC9IZjL.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ge={class:"health-root"},he={class:"dashboard"},we={class:"stat-label"},ke={class:"stat-card total"},Ce={class:"stat-value"},ye={class:"stat-card healthrate"},be={class:"stat-value healthrate"},Ve={class:"stat-search"},xe={class:"card-masonry"},Ne={key:1,class:"masonry-grid"},ze={class:"card-header"},Ue={class:"service-name"},Se={class:"owner"},De=["title"],Be={class:"card-footer"},Fe={class:"last-check"},Me={class:"card-actions"},Ee={class:"pagination center"},Te={key:0},qe={class:"drawer-title"},Ie={class:"drawer-row"},Le={class:"drawer-row"},Re={class:"drawer-row"},$e={class:"drawer-row"},je=ne({__name:"index",setup(Ae){const c=u([{id:1,serviceName:"政务门户",owner:"李明",status:"正常",lastCheck:"2025-05-01 09:00",desc:"门户网站运行正常"},{id:2,serviceName:"人口管理",owner:"王芳",status:"告警",lastCheck:"2025-05-01 08:30",desc:"接口响应慢"},{id:3,serviceName:"视频监控",owner:"赵强",status:"异常",lastCheck:"2025-05-31 17:00",desc:"部分摄像头离线"},{id:4,serviceName:"数据共享",owner:"孙丽",status:"正常",lastCheck:"2025-05-31 16:00",desc:"数据同步正常"},{id:5,serviceName:"应急指挥",owner:"周伟",status:"正常",lastCheck:"2025-05-30 14:00",desc:"服务稳定"},{id:6,serviceName:"资产管理",owner:"马俊",status:"异常",lastCheck:"2025-05-29 11:00",desc:"数据库连接失败"},{id:7,serviceName:"工单系统",owner:"许静",status:"正常",lastCheck:"2025-05-28 09:00",desc:"无异常"},{id:8,serviceName:"能耗监控",owner:"宋倩",status:"告警",lastCheck:"2025-05-27 13:00",desc:"能耗超阈值"},{id:9,serviceName:"安全事件",owner:"魏东",status:"正常",lastCheck:"2025-05-26 10:00",desc:"无安全告警"},{id:10,serviceName:"备份任务",owner:"冯媛",status:"正常",lastCheck:"2025-05-25 15:00",desc:"备份完成"}]),z=u([]),n=B({normal:0,error:0,warning:0,total:0}),R=q(()=>[{label:"正常",value:n.normal,percent:n.total?Math.round(n.normal/n.total*100):0,color:"#67C23A",status:"正常"},{label:"异常",value:n.error,percent:n.total?Math.round(n.error/n.total*100):0,color:"#F56C6C",status:"异常"},{label:"告警",value:n.warning,percent:n.total?Math.round(n.warning/n.total*100):0,color:"#E6A23C",status:"告警"}]),$=q(()=>n.total?Math.round(n.normal/n.total*100):0),p=B({keyword:"",status:""}),C=u(1),y=u(10),M=u(0),k=u(!1),x=u("add"),U=u(),o=B({id:0,serviceName:"",owner:"",status:"正常",lastCheck:"",desc:""}),S=u(!1),D=u(!1),m=u(null),j={serviceName:[{required:!0,message:"请输入服务名称",trigger:"blur"}],owner:[{required:!0,message:"请输入负责人",trigger:"blur"}],status:[{required:!0,message:"请选择健康状态",trigger:"change"}],lastCheck:[{required:!0,message:"请选择最近检查时间",trigger:"change"}]};function _(){let a=[...c.value];p.keyword&&(a=a.filter(e=>e.serviceName.includes(p.keyword)||e.owner.includes(p.keyword))),p.status&&(a=a.filter(e=>e.status===p.status)),M.value=a.length,z.value=a.slice((C.value-1)*y.value,C.value*y.value),Q()}const A=()=>{x.value="add",k.value=!0,o.id=0,o.serviceName="",o.owner="",o.status="正常",o.lastCheck="",o.desc=""},H=a=>{x.value="edit",k.value=!0,Object.assign(o,a)},K=a=>{_e.confirm("确定要删除该服务吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=c.value.findIndex(b=>b.id===a.id);e!==-1&&(c.value.splice(e,1),_(),F.success("删除成功"))})},P=async()=>{U.value&&(S.value=!0,await U.value.validate(a=>{if(a){if(x.value==="add"){const e={...o,id:Date.now()};c.value.unshift(e),_(),F.success("新增成功")}else{const e=c.value.findIndex(b=>b.id===o.id);e!==-1&&(c.value[e]={...o,id:o.id},_(),F.success("修改成功"))}k.value=!1}S.value=!1}))},O=a=>{y.value=a,_()},G=a=>{C.value=a,_()},J=a=>{m.value=a,D.value=!0};function Q(){n.normal=c.value.filter(a=>a.status==="正常").length,n.error=c.value.filter(a=>a.status==="异常").length,n.warning=c.value.filter(a=>a.status==="告警").length,n.total=c.value.length}function W(a){return a==="正常"?"success":a==="异常"?"danger":a==="告警"?"warning":"info"}function X(){m.value=null}return re(()=>{_()}),(a,e)=>{const b=d("el-progress"),N=d("el-input"),g=d("el-option"),E=d("el-select"),h=d("el-button"),Y=d("el-empty"),Z=d("el-pagination"),V=d("el-form-item"),ee=d("el-date-picker"),le=d("el-form"),te=d("el-dialog"),ae=d("el-tag"),se=d("el-drawer"),oe=d("el-icon");return f(),w("div",ge,[s("div",he,[(f(!0),w(I,null,L(R.value,l=>(f(),w("div",{class:"stat-card",key:l.label},[t(b,{type:"circle",percentage:l.percent,color:l.color,width:54,"stroke-width":6,"show-text":!1},null,8,["percentage","color"]),s("div",we,i(l.label),1),s("div",{class:"stat-value",style:pe({color:l.color})},i(l.value),5)]))),128)),s("div",ke,[e[12]||(e[12]=s("div",{class:"stat-label"},"服务总数",-1)),s("div",Ce,i(n.total),1)]),s("div",ye,[e[13]||(e[13]=s("div",{class:"stat-label"},"健康率",-1)),s("div",be,i($.value)+"%",1)]),s("div",Ve,[t(N,{modelValue:p.keyword,"onUpdate:modelValue":e[0]||(e[0]=l=>p.keyword=l),placeholder:"服务名称/负责人",clearable:"",onKeyup:de(_,["enter"]),size:"small"},null,8,["modelValue"]),t(E,{modelValue:p.status,"onUpdate:modelValue":e[1]||(e[1]=l=>p.status=l),placeholder:"健康状态",clearable:"",size:"small",style:{width:"110px","margin-left":"8px"}},{default:r(()=>[t(g,{label:"全部",value:""}),t(g,{label:"正常",value:"正常"}),t(g,{label:"异常",value:"异常"}),t(g,{label:"告警",value:"告警"})]),_:1},8,["modelValue"]),t(h,{type:"primary",size:"small",onClick:_,style:{"margin-left":"8px"}},{default:r(()=>e[14]||(e[14]=[v("搜索")])),_:1,__:[14]})])]),s("div",xe,[z.value.length?(f(),w("div",Ne,[(f(!0),w(I,null,L(z.value,l=>(f(),w("div",{key:l.id,class:"health-card"},[s("div",ze,[s("span",{class:me(["status-dot",l.status])},null,2),s("span",Ue,i(l.serviceName),1),s("span",Se,i(l.owner),1)]),s("div",{class:"card-desc",title:l.desc},i(l.desc),9,De),s("div",Be,[s("span",Fe,"最近检查："+i(l.lastCheck),1),s("div",Me,[t(h,{type:"primary",link:"",size:"small",onClick:T=>J(l)},{default:r(()=>e[15]||(e[15]=[v("详情")])),_:2,__:[15]},1032,["onClick"]),t(h,{type:"success",link:"",size:"small",onClick:T=>H(l)},{default:r(()=>e[16]||(e[16]=[v("编辑")])),_:2,__:[16]},1032,["onClick"]),t(h,{type:"danger",link:"",size:"small",onClick:T=>K(l)},{default:r(()=>e[17]||(e[17]=[v("删除")])),_:2,__:[17]},1032,["onClick"])])])]))),128))])):(f(),ie(Y,{key:0,description:"暂无服务"}))]),s("div",Ee,[t(Z,{"current-page":C.value,"onUpdate:currentPage":e[2]||(e[2]=l=>C.value=l),"page-size":y.value,"onUpdate:pageSize":e[3]||(e[3]=l=>y.value=l),"page-sizes":[10,20,50,100],total:M.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:O,onCurrentChange:G},null,8,["current-page","page-size","total"])]),t(te,{modelValue:k.value,"onUpdate:modelValue":e[10]||(e[10]=l=>k.value=l),title:x.value==="add"?"新增服务":"编辑服务",width:"500px"},{footer:r(()=>[t(h,{onClick:e[9]||(e[9]=l=>k.value=!1)},{default:r(()=>e[18]||(e[18]=[v("取消")])),_:1,__:[18]}),t(h,{type:"primary",loading:S.value,onClick:P},{default:r(()=>e[19]||(e[19]=[v("确定")])),_:1,__:[19]},8,["loading"])]),default:r(()=>[t(le,{ref_key:"healthFormRef",ref:U,model:o,rules:j,"label-width":"90px"},{default:r(()=>[t(V,{label:"服务名称",prop:"serviceName"},{default:r(()=>[t(N,{modelValue:o.serviceName,"onUpdate:modelValue":e[4]||(e[4]=l=>o.serviceName=l),placeholder:"请输入服务名称"},null,8,["modelValue"])]),_:1}),t(V,{label:"负责人",prop:"owner"},{default:r(()=>[t(N,{modelValue:o.owner,"onUpdate:modelValue":e[5]||(e[5]=l=>o.owner=l),placeholder:"请输入负责人"},null,8,["modelValue"])]),_:1}),t(V,{label:"健康状态",prop:"status"},{default:r(()=>[t(E,{modelValue:o.status,"onUpdate:modelValue":e[6]||(e[6]=l=>o.status=l),placeholder:"请选择健康状态",style:{width:"140px"}},{default:r(()=>[t(g,{label:"正常",value:"正常"}),t(g,{label:"异常",value:"异常"}),t(g,{label:"告警",value:"告警"})]),_:1},8,["modelValue"])]),_:1}),t(V,{label:"最近检查",prop:"lastCheck"},{default:r(()=>[t(ee,{modelValue:o.lastCheck,"onUpdate:modelValue":e[7]||(e[7]=l=>o.lastCheck=l),type:"datetime",placeholder:"选择时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(V,{label:"描述",prop:"desc"},{default:r(()=>[t(N,{modelValue:o.desc,"onUpdate:modelValue":e[8]||(e[8]=l=>o.desc=l),placeholder:"请输入描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(se,{modelValue:D.value,"onUpdate:modelValue":e[11]||(e[11]=l=>D.value=l),title:"服务详情",size:"400px",direction:"rtl",onClose:X},{default:r(()=>[m.value?(f(),w("div",Te,[s("div",qe,i(m.value.serviceName),1),s("div",Ie,[e[20]||(e[20]=s("b",null,"负责人：",-1)),v(i(m.value.owner),1)]),s("div",Le,[e[21]||(e[21]=s("b",null,"健康状态：",-1)),t(ae,{type:W(m.value.status)},{default:r(()=>[v(i(m.value.status),1)]),_:1},8,["type"])]),s("div",Re,[e[22]||(e[22]=s("b",null,"最近检查：",-1)),v(i(m.value.lastCheck),1)]),s("div",$e,[e[23]||(e[23]=s("b",null,"描述：",-1)),v(i(m.value.desc),1)])])):ue("",!0)]),_:1},8,["modelValue"]),t(h,{class:"fab",type:"primary",circle:"",onClick:A},{default:r(()=>[t(oe,null,{default:r(()=>[t(ce(ve))]),_:1})]),_:1})])}}}),Pe=fe(je,[["__scopeId","data-v-710c8887"]]);export{Pe as default};
