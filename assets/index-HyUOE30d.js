import{d as Be,a as te,r,v as De,D as Pe,c as N,b as k,m as w,H as C,e as l,w as a,f as s,i as Se,F as ae,n as ne,j as i,g as K,I as oe,J as Ee,t as R,K as $,E as f,o as v}from"./index-DU_xkYU3.js";import{_ as Fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const qe={class:"user-container"},je={class:"operation-bar"},Ie={class:"operation-buttons"},Me={class:"pagination"},Ne={class:"dialog-footer"},Ke={class:"role-operation"},Oe={class:"table-actions"},Ae=Be({__name:"index",setup(He){const o=te({keyword:"",role:"",status:""}),B=[{label:"系统管理员",value:"系统管理员"},{label:"社区管理员",value:"社区管理员"},{label:"网格员",value:"网格员"},{label:"便民服务人员",value:"便民服务人员"},{label:"养老服务专员",value:"养老服务专员"},{label:"文化活动专员",value:"文化活动专员"},{label:"环境监测员",value:"环境监测员"},{label:"志愿服务管理员",value:"志愿服务管理员"},{label:"社区医生",value:"社区医生"}],_=[{id:1,username:"wangxq",name:"王晓强",phone:"13953701245",email:"wangxq@xinglongzhuang.gov.cn",department:"街道信息化办公室",position:"主任",role:"系统管理员",status:"active",lastLogin:"2025-05-03 08:12",createTime:"2025-05-02 09:23"},{id:2,username:"liwn",name:"李文娜",phone:"13853712561",email:"liwn@xinglongzhuang.gov.cn",department:"街道信息化办公室",position:"副主任",role:"社区管理员",status:"active",lastLogin:"2025-05-07 10:45",createTime:"2025-05-06 14:11"},{id:3,username:"liuzhy",name:"刘志洋",phone:"18653734576",email:"liuzhy@xinglongzhuang.gov.cn",department:"社区服务中心",position:"网格员",role:"网格员",status:"active",lastLogin:"2025-05-10 16:08",createTime:"2025-05-09 13:37"},{id:4,username:"zhanglm",name:"张丽敏",phone:"15053745652",email:"zhanglm@xinglongzhuang.gov.cn",department:"便民服务中心",position:"便民服务人员",role:"便民服务人员",status:"active",lastLogin:"2025-05-12 09:56",createTime:"2025-05-11 10:05"},{id:5,username:"chengl",name:"陈国磊",phone:"15153756984",email:"chengl@xinglongzhuang.gov.cn",department:"社区服务中心",position:"养老服务专员",role:"养老服务专员",status:"active",lastLogin:"2025-05-15 11:22",createTime:"2025-05-14 08:44"},{id:6,username:"sunxy",name:"孙晓宇",phone:"15253767690",email:"sunxy@xinglongzhuang.gov.cn",department:"社区服务中心",position:"文化活动专员",role:"文化活动专员",status:"active",lastLogin:"2025-05-16 15:33",createTime:"2025-05-15 16:18"},{id:7,username:"zhoujl",name:"周建林",phone:"15353778901",email:"zhoujl@xinglongzhuang.gov.cn",department:"社区服务中心",position:"环境监测员",role:"环境监测员",status:"active",lastLogin:"2025-05-17 07:41",createTime:"2025-05-16 12:29"},{id:8,username:"huangyy",name:"黄雅雯",phone:"15553789012",email:"huangyy@xinglongzhuang.gov.cn",department:"社区服务中心",position:"志愿服务管理员",role:"志愿服务管理员",status:"active",lastLogin:"2025-05-18 18:09",createTime:"2025-05-17 19:55"},{id:9,username:"liuhh",name:"刘慧慧",phone:"15653790123",email:"liuhh@xinglongzhuang.gov.cn",department:"社区卫生服务站",position:"社区医生",role:"社区医生",status:"active",lastLogin:"2025-05-19 20:17",createTime:"2025-05-18 21:03"},{id:10,username:"gaoyt",name:"高宇涛",phone:"15753791234",email:"gaoyt@xinglongzhuang.gov.cn",department:"街道信息化办公室",position:"系统管理员",role:"系统管理员",status:"active",lastLogin:"2025-05-20 13:28",createTime:"2025-05-19 14:39"}],O=r([]),b=r(1),h=r(10),D=r(100),y=r(!1),T=r("add"),P=r(),u=te({id:0,username:"",name:"",phone:"",email:"",department:"",position:"",role:"",status:"正常",lastLogin:"",createTime:""}),S=r(!1),E=r("list"),z=r([]),se=r(),A=r([{id:1,name:"系统管理",children:[{id:11,name:"用户管理"},{id:12,name:"角色管理"},{id:13,name:"权限管理"}]},{id:2,name:"设备管理",children:[{id:21,name:"设备列表"},{id:22,name:"设备监控"},{id:23,name:"设备维护"}]}]),H=r([11,21]),J=n=>{const e=B.find(p=>p.value===n);return e?e.label:n},c=()=>{let n=[..._];o.keyword&&(n=n.filter(e=>e.username.includes(o.keyword)||e.phone.includes(o.keyword))),o.role&&(n=n.filter(e=>e.role===o.role)),o.status&&(n=n.filter(e=>e.status===o.status)),D.value=n.length,O.value=n.slice((b.value-1)*h.value,b.value*h.value)},G=()=>{o.keyword="",o.role="",o.status="",b.value=1,c()},ie=()=>{T.value="add",y.value=!0,Object.assign(u,{id:Date.now(),username:"",name:"",phone:"",email:"",department:"",position:"",role:"",status:"正常",lastLogin:"",createTime:""})},ue=n=>{T.value="edit",y.value=!0,Object.assign(u,n)},re=n=>{$.confirm("确定要删除该用户吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=_.findIndex(p=>p.id===n.id);e!==-1&&(_.splice(e,1),c(),f.success("删除成功"),D.value=_.length)})},de=n=>{n.status=n.status==="active"?"inactive":"active";const e=n.status==="active"?"启用":"禁用";f.success(`已${e}用户：${n.username}`)},me=async()=>{P.value&&await P.value.validate(n=>{if(n){if(T.value==="add"){const e={...u,id:Date.now(),createTime:new Date().toLocaleString(),lastLogin:""};_.unshift(e),c(),f.success("新增成功")}else{const e=_.findIndex(p=>p.id===u.id);e!==-1&&(_[e]={...u,id:u.id,createTime:u.createTime,lastLogin:u.lastLogin},c(),f.success("修改成功"))}y.value=!1}})},pe=n=>{h.value=n,c()},ce=n=>{b.value=n,c()},ge=()=>{S.value=!0},fe=()=>{$.prompt("请输入新角色名称","新增角色",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{2,20}$/,inputErrorMessage:"角色名称长度为2-20个字符"}).then(({value:n})=>{const e={id:Date.now(),name:n,description:"",permissions:[],createTime:new Date().toLocaleString()};z.value.push(e),f.success("新增角色成功")})},ve=n=>{$.prompt("请输入新的角色名称","编辑角色",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:n.name,inputPattern:/^.{2,20}$/,inputErrorMessage:"角色名称长度为2-20个字符"}).then(({value:e})=>{n.name=e,f.success("编辑角色成功")})},_e=n=>{$.confirm("确定要删除该角色吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=z.value.findIndex(p=>p.id===n.id);e!==-1&&(z.value.splice(e,1),f.success("删除成功"))})},be=n=>{E.value="permission",H.value=[11,21],f.info(`为角色【${n.name}】分配权限（仅模拟）`)},x=r(!1),ye=r([]),ke=r(null),Q=r(),he=n=>{var e;ke.value=n.id,(e=Q.value)==null||e.setCheckedKeys(["1","1-1","1-2"]),x.value=!0},xe=()=>{f.success("权限已保存（仅模拟）"),x.value=!1},W=De(()=>!!o.role||!!o.status||!!o.keyword),F=n=>{o[n]="",b.value=1,c()},Ve={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]};return Pe(()=>{c()}),(n,e)=>{const p=s("el-input"),g=s("el-form-item"),L=s("el-option"),q=s("el-select"),d=s("el-button"),X=s("el-form"),j=s("el-icon"),U=s("el-tag"),we=s("el-row"),m=s("el-table-column"),Ce=s("el-switch"),I=s("el-dropdown-item"),Te=s("el-dropdown-menu"),ze=s("el-dropdown"),Y=s("el-table"),Le=s("el-pagination"),Ue=s("el-card"),Z=s("el-radio"),Re=s("el-radio-group"),M=s("el-dialog"),ee=s("el-tree"),le=s("el-tab-pane"),$e=s("el-tabs");return v(),N("div",qe,[k("div",je,[l(X,{inline:!0,model:o,class:"search-form"},{default:a(()=>[l(g,null,{default:a(()=>[l(p,{modelValue:o.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>o.keyword=t),placeholder:"用户名/手机号",clearable:"",onKeyup:Se(c,["enter"])},null,8,["modelValue"])]),_:1}),l(g,null,{default:a(()=>[l(q,{modelValue:o.role,"onUpdate:modelValue":e[1]||(e[1]=t=>o.role=t),placeholder:"角色",clearable:"",style:{width:"140px"}},{default:a(()=>[(v(),N(ae,null,ne(B,t=>l(L,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(g,null,{default:a(()=>[l(q,{modelValue:o.status,"onUpdate:modelValue":e[2]||(e[2]=t=>o.status=t),placeholder:"状态",clearable:"",style:{width:"140px"}},{default:a(()=>[l(L,{label:"启用",value:"active"}),l(L,{label:"禁用",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),l(g,null,{default:a(()=>[l(d,{type:"primary",onClick:c},{default:a(()=>e[20]||(e[20]=[i("搜索")])),_:1,__:[20]}),l(d,{onClick:G},{default:a(()=>e[21]||(e[21]=[i("重置")])),_:1,__:[21]})]),_:1})]),_:1},8,["model"]),k("div",Ie,[l(d,{type:"primary",onClick:ie},{default:a(()=>[l(j,null,{default:a(()=>[l(K(oe))]),_:1}),e[22]||(e[22]=i("新增用户 "))]),_:1,__:[22]}),l(d,{type:"success",onClick:ge},{default:a(()=>[l(j,null,{default:a(()=>[l(K(Ee))]),_:1}),e[23]||(e[23]=i("角色管理 "))]),_:1,__:[23]})])]),W.value?(v(),w(we,{key:0,class:"filter-tags",style:{"margin-bottom":"10px"}},{default:a(()=>[o.role?(v(),w(U,{key:0,type:"info",closable:"",onClose:e[3]||(e[3]=()=>F("role"))},{default:a(()=>[i(" 角色："+R(J(o.role)),1)]),_:1})):C("",!0),o.status?(v(),w(U,{key:1,type:"info",closable:"",onClose:e[4]||(e[4]=()=>F("status"))},{default:a(()=>[i(" 状态："+R(o.status==="active"?"启用":"禁用"),1)]),_:1})):C("",!0),o.keyword?(v(),w(U,{key:2,type:"info",closable:"",onClose:e[5]||(e[5]=()=>F("keyword"))},{default:a(()=>[i(" 关键词："+R(o.keyword),1)]),_:1})):C("",!0),W.value?(v(),w(d,{key:3,size:"small",type:"text",onClick:G},{default:a(()=>e[24]||(e[24]=[i("清除全部")])),_:1,__:[24]})):C("",!0)]),_:1})):C("",!0),l(Ue,{class:"user-list"},{default:a(()=>[l(Y,{data:O.value,border:"",style:{width:"100%"},"highlight-current-row":""},{default:a(()=>[l(m,{type:"selection",width:"55"}),l(m,{prop:"username",label:"用户名","min-width":"120"}),l(m,{prop:"name",label:"姓名","min-width":"120"}),l(m,{prop:"phone",label:"手机号","min-width":"120"}),l(m,{prop:"email",label:"邮箱","min-width":"180"}),l(m,{prop:"role",label:"角色","min-width":"120"},{default:a(({row:t})=>[l(U,{type:t.role==="系统管理员"?"danger":t.role==="社区管理员"?"primary":t.role==="网格员"?"warning":t.role==="便民服务人员"?"success":t.role==="养老服务专员"?"info":t.role==="文化活动专员"?"success":t.role==="环境监测员"?"warning":t.role==="志愿服务管理员"?"primary":t.role==="社区医生"?"success":"default"},{default:a(()=>[i(R(J(t.role)),1)]),_:2},1032,["type"])]),_:1}),l(m,{prop:"status",label:"状态",width:"100"},{default:a(({row:t})=>[l(Ce,{"model-value":t.status,"active-value":"active","inactive-value":"inactive",onClick:()=>de(t)},null,8,["model-value","onClick"])]),_:1}),l(m,{prop:"createTime",label:"创建时间","min-width":"180"}),l(m,{label:"操作",width:"120"},{default:a(({row:t})=>[l(ze,null,{dropdown:a(()=>[l(Te,null,{default:a(()=>[l(I,{onClick:V=>ue(t)},{default:a(()=>e[26]||(e[26]=[i("编辑")])),_:2,__:[26]},1032,["onClick"]),l(I,{onClick:V=>he(t)},{default:a(()=>e[27]||(e[27]=[i("权限")])),_:2,__:[27]},1032,["onClick"]),l(I,{divided:"",onClick:V=>re(t),style:{color:"red"}},{default:a(()=>e[28]||(e[28]=[i("删除")])),_:2,__:[28]},1032,["onClick"])]),_:2},1024)]),default:a(()=>[l(d,{link:""},{default:a(()=>e[25]||(e[25]=[i("更多")])),_:1,__:[25]})]),_:2},1024)]),_:1})]),_:1},8,["data"]),k("div",Me,[l(Le,{"current-page":b.value,"onUpdate:currentPage":e[6]||(e[6]=t=>b.value=t),"page-size":h.value,"onUpdate:pageSize":e[7]||(e[7]=t=>h.value=t),"page-sizes":[10,20,50,100],total:D.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:pe,onCurrentChange:ce},null,8,["current-page","page-size","total"])])]),_:1}),l(M,{modelValue:y.value,"onUpdate:modelValue":e[15]||(e[15]=t=>y.value=t),title:T.value==="add"?"新增用户":"编辑用户",width:"500px"},{footer:a(()=>[k("span",Ne,[l(d,{onClick:e[14]||(e[14]=t=>y.value=!1)},{default:a(()=>e[31]||(e[31]=[i("取消")])),_:1,__:[31]}),l(d,{type:"primary",onClick:me},{default:a(()=>e[32]||(e[32]=[i("确定")])),_:1,__:[32]})])]),default:a(()=>[l(X,{ref_key:"userFormRef",ref:P,model:u,rules:Ve,"label-width":"80px"},{default:a(()=>[l(g,{label:"用户名",prop:"username"},{default:a(()=>[l(p,{modelValue:u.username,"onUpdate:modelValue":e[8]||(e[8]=t=>u.username=t),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(g,{label:"姓名",prop:"name"},{default:a(()=>[l(p,{modelValue:u.name,"onUpdate:modelValue":e[9]||(e[9]=t=>u.name=t),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),l(g,{label:"手机号",prop:"phone"},{default:a(()=>[l(p,{modelValue:u.phone,"onUpdate:modelValue":e[10]||(e[10]=t=>u.phone=t),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),l(g,{label:"邮箱",prop:"email"},{default:a(()=>[l(p,{modelValue:u.email,"onUpdate:modelValue":e[11]||(e[11]=t=>u.email=t),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(g,{label:"角色",prop:"role"},{default:a(()=>[l(q,{modelValue:u.role,"onUpdate:modelValue":e[12]||(e[12]=t=>u.role=t),placeholder:"请选择角色"},{default:a(()=>[(v(),N(ae,null,ne(B,t=>l(L,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(g,{label:"状态",prop:"status"},{default:a(()=>[l(Re,{modelValue:u.status,"onUpdate:modelValue":e[13]||(e[13]=t=>u.status=t)},{default:a(()=>[l(Z,{label:"active"},{default:a(()=>e[29]||(e[29]=[i("启用")])),_:1,__:[29]}),l(Z,{label:"inactive"},{default:a(()=>e[30]||(e[30]=[i("禁用")])),_:1,__:[30]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(M,{modelValue:x.value,"onUpdate:modelValue":e[17]||(e[17]=t=>x.value=t),title:"分配权限",width:"400px"},{footer:a(()=>[l(d,{onClick:e[16]||(e[16]=t=>x.value=!1)},{default:a(()=>e[33]||(e[33]=[i("取消")])),_:1,__:[33]}),l(d,{type:"primary",onClick:xe},{default:a(()=>e[34]||(e[34]=[i("保存")])),_:1,__:[34]})]),default:a(()=>[l(ee,{data:A.value,"show-checkbox":"","node-key":"id","default-checked-keys":ye.value,props:{label:"name",children:"children"},ref_key:"userPermissionTreeRef",ref:Q},null,8,["data","default-checked-keys"])]),_:1},8,["modelValue"]),l(M,{modelValue:S.value,"onUpdate:modelValue":e[19]||(e[19]=t=>S.value=t),title:"角色管理",width:"800px"},{default:a(()=>[l($e,{modelValue:E.value,"onUpdate:modelValue":e[18]||(e[18]=t=>E.value=t)},{default:a(()=>[l(le,{label:"角色列表",name:"list"},{default:a(()=>[k("div",Ke,[l(d,{type:"primary",onClick:fe},{default:a(()=>[l(j,null,{default:a(()=>[l(K(oe))]),_:1}),e[35]||(e[35]=i("新增角色 "))]),_:1,__:[35]})]),l(Y,{data:z.value,border:"",style:{width:"100%"}},{default:a(()=>[l(m,{prop:"name",label:"角色名称"}),l(m,{prop:"code",label:"角色编码"}),l(m,{prop:"description",label:"描述"}),l(m,{prop:"createTime",label:"创建时间"}),l(m,{label:"操作",width:"200"},{default:a(({row:t})=>[k("div",Oe,[l(d,{type:"primary",link:"",onClick:V=>ve(t)},{default:a(()=>e[36]||(e[36]=[i("编辑")])),_:2,__:[36]},1032,["onClick"]),l(d,{type:"primary",link:"",onClick:V=>be(t)},{default:a(()=>e[37]||(e[37]=[i("权限")])),_:2,__:[37]},1032,["onClick"]),l(d,{type:"danger",link:"",onClick:V=>_e(t)},{default:a(()=>e[38]||(e[38]=[i("删除")])),_:2,__:[38]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])]),_:1}),l(le,{label:"权限配置",name:"permission"},{default:a(()=>[l(ee,{ref_key:"permissionTreeRef",ref:se,data:A.value,"show-checkbox":"","node-key":"id","default-checked-keys":H.value,props:{label:"name",children:"children"}},null,8,["data","default-checked-keys"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}}),Qe=Fe(Ae,[["__scopeId","data-v-baafc9ee"]]);export{Qe as default};
